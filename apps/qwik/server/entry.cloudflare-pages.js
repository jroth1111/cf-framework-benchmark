import{s as Me,r as Le}from"./build/q-By09E3Qw.js";import{l as Ie,L as F,Q as Ne,a as Ue,b as V,i as ke,c as De,d as Z}from"./build/q-BPCZQrHd.js";import{i as Fe,_ as O,a as Oe,v as We,b as H}from"./build/q-CDjUYjhe.js";function j(e,t){let n="Server Error";return t!=null&&(typeof t.message=="string"?n=t.message:n=String(t)),"<html>"+ce(e,n)+"</html>"}function ce(e,t){typeof e!="number"&&(e=500),typeof t=="string"?t=qe(t):t="";const n=typeof t=="string"?"600px":"300px",r=e>=500?Se:Qe;return`
<head>
  <meta charset="utf-8">
  <meta http-equiv="Status" content="${e}">
  <title>${e} ${t}</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body { color: ${r}; background-color: #fafafa; padding: 30px; font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, Roboto, sans-serif; }
    p { max-width: ${n}; margin: 60px auto 30px auto; background: white; border-radius: 4px; box-shadow: 0px 0px 50px -20px ${r}; overflow: hidden; }
    strong { display: inline-block; padding: 15px; background: ${r}; color: white; }
    span { display: inline-block; padding: 15px; }
  </style>
</head>
<body><p><strong>${e}</strong> <span>${t}</span></p></body>
`}const $e=/[&<>]/g,qe=e=>e.replace($e,t=>{switch(t){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";default:return""}}),Qe="#006ce9",Se="#713fc2";var le=(e=>(e[e.Continue=100]="Continue",e[e.SwitchingProtocols=101]="SwitchingProtocols",e[e.Processing=102]="Processing",e[e.Ok=200]="Ok",e[e.Created=201]="Created",e[e.Accepted=202]="Accepted",e[e.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",e[e.NoContent=204]="NoContent",e[e.ResetContent=205]="ResetContent",e[e.PartialContent=206]="PartialContent",e[e.MultiStatus=207]="MultiStatus",e[e.AlreadyReported=208]="AlreadyReported",e[e.ImUsed=226]="ImUsed",e[e.MultipleChoices=300]="MultipleChoices",e[e.MovedPermanently=301]="MovedPermanently",e[e.Found=302]="Found",e[e.SeeOther=303]="SeeOther",e[e.NotModified=304]="NotModified",e[e.UseProxy=305]="UseProxy",e[e.SwitchProxy=306]="SwitchProxy",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.PermanentRedirect=308]="PermanentRedirect",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.PaymentRequired=402]="PaymentRequired",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.MethodNotAllowed=405]="MethodNotAllowed",e[e.NotAcceptable=406]="NotAcceptable",e[e.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.Gone=410]="Gone",e[e.LengthRequired=411]="LengthRequired",e[e.PreconditionFailed=412]="PreconditionFailed",e[e.PayloadTooLarge=413]="PayloadTooLarge",e[e.UriTooLong=414]="UriTooLong",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.RangeNotSatisfiable=416]="RangeNotSatisfiable",e[e.ExpectationFailed=417]="ExpectationFailed",e[e.IAmATeapot=418]="IAmATeapot",e[e.MisdirectedRequest=421]="MisdirectedRequest",e[e.UnprocessableEntity=422]="UnprocessableEntity",e[e.Locked=423]="Locked",e[e.FailedDependency=424]="FailedDependency",e[e.UpgradeRequired=426]="UpgradeRequired",e[e.PreconditionRequired=428]="PreconditionRequired",e[e.TooManyRequests=429]="TooManyRequests",e[e.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",e[e.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",e[e.InternalServerError=500]="InternalServerError",e[e.NotImplemented=501]="NotImplemented",e[e.BadGateway=502]="BadGateway",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.HttpVersionNotSupported=505]="HttpVersionNotSupported",e[e.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",e[e.InsufficientStorage=507]="InsufficientStorage",e[e.LoopDetected=508]="LoopDetected",e[e.NotExtended=510]="NotExtended",e[e.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",e))(le||{});function Ee(e){const t=[];return e==="day"?e=3600*24:e==="week"?e=3600*24*7:e==="month"?e=3600*24*30:e==="year"?e=3600*24*365:e==="private"?e={private:!0,noCache:!0}:e==="immutable"?e={public:!0,immutable:!0,maxAge:3600*24*365}:e==="no-cache"&&(e={noCache:!0}),typeof e=="number"&&(e={maxAge:e,sMaxAge:e}),e.immutable&&t.push("immutable"),e.maxAge&&t.push(`max-age=${e.maxAge}`),e.sMaxAge&&t.push(`s-maxage=${e.sMaxAge}`),e.noStore&&t.push("no-store"),e.noCache&&t.push("no-cache"),e.private&&t.push("private"),e.public&&t.push("public"),e.staleWhileRevalidate&&t.push(`stale-while-revalidate=${e.staleWhileRevalidate}`),e.staleIfError&&t.push(`stale-if-error=${e.staleIfError}`),t.join(", ")}const je={lax:"Lax",Lax:"Lax",None:"None",none:"None",strict:"Strict",Strict:"Strict"},Ge={seconds:1,minutes:60,hours:3600,days:3600*24,weeks:3600*24*7},ee=(e,t,n)=>{const r=[`${e}=${t}`];typeof n.domain=="string"&&r.push(`Domain=${n.domain}`),typeof n.maxAge=="number"?r.push(`Max-Age=${n.maxAge}`):Array.isArray(n.maxAge)?r.push(`Max-Age=${n.maxAge[0]*Ge[n.maxAge[1]]}`):typeof n.expires=="number"||typeof n.expires=="string"?r.push(`Expires=${n.expires}`):n.expires instanceof Date&&r.push(`Expires=${n.expires.toUTCString()}`),n.httpOnly&&r.push("HttpOnly"),typeof n.path=="string"&&r.push(`Path=${n.path}`);const i=Ke(n.sameSite);return i&&r.push(`SameSite=${i}`),n.secure&&r.push("Secure"),r.join("; ")};function ne(e){try{return decodeURIComponent(e)}catch{return e}}const ze=e=>{const t={};if(typeof e=="string"&&e!==""){const n=e.split(";");for(const r of n){const i=r.indexOf("=");i!==-1&&(t[ne(r.slice(0,i).trim())]=ne(r.slice(i+1).trim()))}}return t};function Ke(e){if(e===!0)return"Strict";if(e===!1)return"None";if(e)return je[e]}const C=Symbol("request-cookies"),D=Symbol("response-cookies"),T=Symbol("live-cookies");class ve{[C];[D]={};[T]={};appendCounter=0;constructor(t){this[C]=ze(t),this[T]={...this[C]}}get(t,n=!0){const r=this[n?T:C][t];return r?{value:r,json(){return JSON.parse(r)},number(){return Number(r)}}:null}getAll(t=!0){return Object.keys(this[t?T:C]).reduce((n,r)=>(n[r]=this.get(r),n),{})}has(t,n=!0){return!!this[n?T:C][t]}set(t,n,r={}){this[T][t]=typeof n=="string"?n:JSON.stringify(n);const i=typeof n=="string"?n:encodeURIComponent(JSON.stringify(n));this[D][t]=ee(t,i,r)}append(t,n,r={}){this[T][t]=typeof n=="string"?n:JSON.stringify(n);const i=typeof n=="string"?n:encodeURIComponent(JSON.stringify(n));this[D][++this.appendCounter]=ee(t,i,r)}delete(t,n){this.set(t,"deleted",{...n,maxAge:0}),this[T][t]=null}headers(){return Object.values(this[D])}}const Be=(e,t)=>{const n=t.headers();if(n.length>0){const r=new Headers(e);for(const i of n)r.append("Set-Cookie",i);return r}return e};function Je(e,t,n,r,i="/"){let o;const a=new Promise(s=>o=s),c=Ye(e,t,n,i,o);return{response:a,requestEv:c,completion:J?J.run(c,te,c,r,o):te(c,r,o)}}async function te(e,t,n){try{(a=>new URL(a.pathname+a.search,a))(e.originalUrl)}catch{const a="Resource Not Found";e.status(404);const c=j(404,a);return e.html(404,c),new $(404,a)}let r=1;async function i(){try{await e.next()}catch(o){if(o instanceof Y)return await e.getWritableStream().close(),o;if(o instanceof Te){if(r>50)return new Error("Infinite rewrite loop");r+=1;const a=new URL(e.url);a.pathname=o.pathname;const{loadedRoute:c,requestHandlers:s}=await t(a);return e.resetRoute(c,s,a),await i()}else{if(o instanceof E)return;if(o instanceof $&&!e.headersSent){const a=o.status,c=e.request.headers.get("Accept");return c&&!c.includes("text/html")?(e.headers.set("Content-Type","application/qwik-json"),e.send(a,await O([o.data]))):e.html(a,j(a,o.data)),o}}if(L(e)!=="dev")try{e.headersSent||(e.headers.set("content-type","text/html; charset=utf-8"),e.cacheControl({noCache:!0}),e.status(500));const a=e.getWritableStream();if(!a.locked){const c=a.getWriter();await c.write(Q.encode(j(500,"Internal Server Error"))),await c.close()}}catch{console.error("Unable to render error page")}return o}}try{return await i()}finally{e.isDirty()||n(null)}}function K(e){const t=e.endsWith(M);if(t){const n=e.length-M.length+0;e=e.slice(0,n),e===""&&(e="/")}return{pathname:e,isInternal:t}}const X="@isQData",M="/q-data.json",de=Symbol("RequestEvLoaders"),fe=Symbol("RequestEvMode"),he=Symbol("RequestEvRoute"),ue=Symbol("RequestEvLoaderSerializationStrategyMap"),me="@routeName",q="@actionId",ge="@actionFormData",Xe="@nonce",pe="@rewrite",v="@serverTiming",we="qData";function Ye(e,t,n,r,i){const{request:o,platform:a,env:c}=e,s=new Map,f=new ve(o.headers.get("cookie")),d=new Headers,u=new URL(o.url),{pathname:m,isInternal:p}=K(u.pathname);p&&(u.pathname=m,s.set(X,!0));let w=-1,y=null,_,A=e.locale,R=200;const _e=async()=>{for(w++;w<n.length;){const l=n[w],h=l(b);ke(h)&&await h,w++}},Ae=(l,h,g=u)=>{t=l,n=h,u.pathname=g.pathname,u.search=g.search,w=-1},P=()=>{if(y!==null)throw new Error("Response already sent")},U=(l,h)=>{if(P(),typeof l=="number"){R=l;const x=b.getWritableStream().getWriter();x.write(typeof h=="string"?Q.encode(h):h),x.close()}else if(R=l.status,l.headers.forEach((g,x)=>{x.toLowerCase()!=="set-cookie"&&d.append(x,g)}),l.headers.getSetCookie().forEach(g=>{const x=g.indexOf("=");if(x===-1)return;const Pe=g.slice(0,x).trim(),Ce=g.slice(x+1).trim();f.set(Pe,Ce)}),l.body){const g=b.getWritableStream();l.body.pipeTo(g)}else b.getWritableStream().getWriter().close();return k()},k=(l=new E)=>(w=re,l),I={},b={[de]:I,[ue]:new Map,[fe]:e.mode,get[he](){return t},cookie:f,headers:d,env:c,method:o.method,signal:o.signal,originalUrl:new URL(u),get params(){return t?.[F.Params]??{}},get pathname(){return u.pathname},platform:a,get query(){return u.searchParams},request:o,url:u,basePathname:r,sharedMap:s,get headersSent(){return y!==null},get exited(){return w>=re},get clientConn(){return e.getClientConn()},next:_e,resetRoute:Ae,exit:k,cacheControl:(l,h="Cache-Control")=>{P(),d.set(h,Ee(l))},resolveValue:(async l=>{const h=l.__id;if(l.__brand==="server_loader"){if(!(h in I))throw new Error("You can not get the returned data of a loader that has not been executed for this request.");if(I[h]===Oe){const g=L(b)==="dev";await Re(l,I,b,g)}}return I[h]}),status:l=>typeof l=="number"?(P(),R=l,l):R,locale:l=>(typeof l=="string"&&(A=l),A||""),error:(l,h)=>(R=l,d.delete("Cache-Control"),new $(l,h)),redirect:(l,h)=>{if(P(),R=l,h){if(/([^:])\/{2,}/.test(h)){const g=h.replace(/([^:])\/{2,}/g,"$1/");console.warn(`Redirect URL ${h} is invalid, fixing to ${g}`),h=g}d.set("Location",h)}return d.delete("Cache-Control"),l>301&&d.set("Cache-Control","no-store"),k(new Y)},rewrite:l=>{if(P(),l.startsWith("http"))throw new Error("Rewrite does not support absolute urls");return s.set(pe,!0),k(new Te(l.replace(/\/+/g,"/")))},defer:l=>typeof l=="function"?l:()=>l,fail:(l,h)=>(P(),R=l,d.delete("Cache-Control"),{failed:!0,...h}),text:(l,h)=>(d.set("Content-Type","text/plain; charset=utf-8"),U(l,h)),html:(l,h)=>(d.set("Content-Type","text/html; charset=utf-8"),U(l,h)),parseBody:async()=>_!==void 0?_:_=Ze(b,s),json:(l,h)=>(d.set("Content-Type","application/json; charset=utf-8"),U(l,JSON.stringify(h))),send:U,isDirty:()=>y!==null,getWritableStream:()=>{if(y===null){if(e.mode==="dev"){const l=s.get(v);l&&d.set("Server-Timing",l.map(([h,g])=>`${h};dur=${g}`).join(","))}y=e.getWritableStream(R,d,f,i,b)}return y}};return Object.freeze(b)}function N(e){return e[de]}function ye(e){return e[ue]}function Ve(e){return e[he]}function L(e){return e[fe]}const re=Number.MAX_SAFE_INTEGER,Ze=async({request:e,method:t,query:n},r)=>{const i=e.headers.get("content-type")?.split(/[;,]/,1)[0].trim()??"";if(i==="application/x-www-form-urlencoded"||i==="multipart/form-data"){const o=await e.formData();return r.set(ge,o),He(o)}else{if(i==="application/json")return await e.json();if(i==="application/qwik-json"){if(t==="GET"&&n.has(Z)){const o=n.get(Z);if(o)try{return H(decodeURIComponent(o))}catch{}}return H(await e.text())}}},He=e=>[...e.entries()].reduce((n,[r,i])=>(r.split(".").reduce((o,a,c,s)=>{if(a.endsWith("[]")){const f=a.slice(0,-2);return o[f]=o[f]||[],o[f]=[...o[f],i]}return c<s.length-1?o[a]=o[a]||(Number.isNaN(+s[c+1])?{}:[]):o[a]=i},n),n),{});function en(e){const{params:t,request:n,status:r,locale:i,originalUrl:o}=e,a={};n.headers.forEach((A,R)=>a[R]=A);const c=e.sharedMap.get(q),s=e.sharedMap.get(ge),f=e.sharedMap.get(me),d=e.sharedMap.get(Xe),u=e.request.headers,m=new URL(o.pathname+o.search,o),p=u.get("X-Forwarded-Host"),w=u.get("X-Forwarded-Proto");p&&(m.port="",m.host=p),w&&(m.protocol=w);const y=N(e),_=ye(e);return{url:m.href,requestHeaders:a,locale:i(),nonce:d,containerAttributes:{[De]:f},qwikrouter:{routeName:f,ev:e,params:{...t},loadedRoute:Ve(e),response:{status:r(),loaders:y,loadersSerializationStrategy:_,action:c,formData:s}}}}const nn=(e,t,n,r,i,o)=>{const a=[],c=[],s=[],f=!!(t&&cn(t[F.Mods]));if(o&&s.push(hn),e&&oe(a,c,s,e,f,n),t){const d=t[F.Mods];oe(a,c,s,d,f,n);const u=t[F.RouteName];r&&(n==="POST"||n==="PUT"||n==="PATCH"||n==="DELETE")&&(r==="lax-proto"?s.unshift(ln):s.unshift(dn)),f&&((n==="POST"||n==="GET")&&s.push(an),s.push(sn),o&&s.push(un)),f&&(s.push(m=>{m.sharedMap.set(me,u)}),s.push(tn(c)),s.push(rn(a)),s.push(i))}return s},oe=(e,t,n,r,i,o)=>{for(const a of r){typeof a.onRequest=="function"?n.push(a.onRequest):Array.isArray(a.onRequest)&&n.push(...a.onRequest);let c;switch(o){case"GET":{c=a.onGet;break}case"POST":{c=a.onPost;break}case"PUT":{c=a.onPut;break}case"PATCH":{c=a.onPatch;break}case"DELETE":{c=a.onDelete;break}case"OPTIONS":{c=a.onOptions;break}case"HEAD":{c=a.onHead;break}}if(typeof c=="function"?n.push(c):Array.isArray(c)&&n.push(...c),i)for(const s of Object.values(a))typeof s=="function"&&(s.__brand==="server_loader"?e.push(s):s.__brand==="server_action"&&t.push(s))}};function tn(e){return async t=>{const n=t;if(n.headersSent){n.exit();return}const{method:r}=n,i=N(n),o=L(n)==="dev";if(o&&r==="GET"&&n.query.has(V)&&console.warn(`Seems like you are submitting a Qwik Action via GET request. Qwik Actions should be submitted via POST request.
Make sure your <form> has method="POST" attribute, like this: <form method="POST">`),r==="POST"){const a=n.query.get(V);if(a){const c=globalThis._qwikActionsMap,s=e.find(f=>f.__id===a)??c?.get(a);if(s){n.sharedMap.set(q,a);const f=await n.parseBody();if(!f||typeof f!="object")throw new Error(`Expected request data for the action id ${a} to be an object`);const d=await be(n,s.__validators,f,o);if(!d.success)i[a]=n.fail(d.status??500,d.error);else{const u=o?await S(n,s.__qrl.getHash(),()=>s.__qrl.call(n,d.data,n)):await s.__qrl.call(n,d.data,n);o&&W(u,s.__qrl),i[a]=u}}}}}}function rn(e){return async t=>{const n=t;if(n.headersSent){n.exit();return}const r=N(n),i=L(n)==="dev";if(e.length>0){const o=e.map(a=>Re(a,r,n,i));await Promise.all(o)}}}async function Re(e,t,n,r){const i=e.__id;return t[i]=be(n,e.__validators,void 0,r).then(a=>a.success?r?S(n,e.__qrl.getHash(),()=>e.__qrl.call(n,n)):e.__qrl.call(n,n):n.fail(a.status??500,a.error)).then(a=>(typeof a=="function"?t[i]=a():(r&&W(a,e.__qrl),t[i]=a),a)),ye(n).set(i,e.__serializationStrategy),t[i]}async function be(e,t,n,r){let i={success:!0,data:n};if(t)for(const o of t)if(r?i=await S(e,"validator$",()=>o.validate(e,n)):i=await o.validate(e,n),i.success)n=i.data;else return i;return i}function on(e){return e?typeof e=="object"&&Symbol.asyncIterator in e:!1}async function an(e){const t=e.query.get(Ne);if(t&&e.request.headers.get("X-QRL")===t&&e.request.headers.get("Content-Type")==="application/qwik-json"){e.exit();const n=L(e)==="dev",r=await e.parseBody();if(Array.isArray(r)){const i=Fe(null,t,r[1]);let o;try{n?o=await S(e,`server_${t}`,()=>i.apply(e,r[0])):o=await i.apply(e,r[0])}catch(a){throw a instanceof $?e.error(a.status,a.data):(console.error(`Server function ${t} failed:`,a),e.error(500,"Invalid request"))}if(on(o)){e.headers.set("Content-Type","text/qwik-json-stream");const c=e.getWritableStream().getWriter();for await(const s of o){n&&W(s,i);const f=await O([s]);if(e.signal.aborted)break;await c.write(Q.encode(`${f}
`))}c.close()}else{W(o,i),e.headers.set("Content-Type","application/qwik-json");const a=await O([o]);e.send(200,a)}return}throw e.error(500,"Invalid request")}}function sn(e){const{basePathname:t,originalUrl:n,sharedMap:r}=e,{pathname:i,search:o}=n;if(!r.has(X)&&i!==t&&!i.endsWith(".html")&&i.endsWith("/"))throw e.redirect(le.MovedPermanently,i.slice(0,i.length-1)+o)}function W(e,t){try{We(e,void 0)}catch(n){throw n instanceof Error&&t.dev&&(n.loc=t.dev),n}}function cn(e){const t=e[e.length-1];return t&&typeof t.default=="function"}function B(e){e=new URL(e),e.pathname.endsWith(M)&&(e.pathname=e.pathname.slice(0,-M.length)),e.pathname.endsWith("/")&&(e.pathname=e.pathname.slice(0,-1));const t=e.search.slice(1).replaceAll(/&?q(action|data|func|loaders)=[^&]+/g,"");return`${e.pathname}${t?`?${t}`:""}${e.hash}`}const Q=new TextEncoder;function ln(e){xe(e,"lax-proto")}function dn(e){xe(e)}function xe(e,t){if(gn(e.request.headers,"application/x-www-form-urlencoded","multipart/form-data","text/plain")){const r=e.request.headers.get("origin"),i=e.url.origin;let o=r!==i;if(o&&t&&r?.replace(/^http(s)?/g,"")===i.replace(/^http(s)?/g,"")&&(o=!1),o)throw e.error(403,`CSRF check failed. Cross-site ${e.method} form submissions are forbidden.
The request origin "${r}" does not match the server origin "${i}".`)}}function fn(e){return async t=>{if(t.headersSent||t.sharedMap.has(X))return;t.request.headers.forEach((d,u)=>d);const r=t.headers;r.has("Content-Type")||r.set("Content-Type","text/html; charset=utf-8");const{readable:i,writable:o}=new TextEncoderStream,a=t.getWritableStream(),c=i.pipeTo(a,{preventClose:!0}),s=o.getWriter(),f=t.status();try{const d=L(t)==="static",u=en(t),m=await e({base:t.basePathname+"build/",stream:s,serverData:u,containerAttributes:{"q:render":d?"static":"",...u.containerAttributes}}),p={loaders:N(t),action:t.sharedMap.get(q),status:f!==200?f:200,href:B(t.url)};typeof m.html=="string"&&await s.write(m.html),t.sharedMap.set(we,p)}finally{await s.ready,await s.close(),await c}await a.close()}}async function hn(e){try{await e.next()}catch(i){if(!(i instanceof Y))throw i}if(e.headersSent)return;const t=e.status(),n=e.headers.get("Location");if(t>=301&&t<=308&&n){const i=mn(n);if(i){e.headers.set("Location",i),e.getWritableStream().close();return}else e.status(200),e.headers.delete("Location")}}async function un(e){if(await e.next(),e.headersSent||e.exited)return;const t=e.status(),n=e.headers.get("Location");e.request.headers.forEach((f,d)=>f),e.headers.set("Content-Type","application/json; charset=utf-8");let r=N(e);const i=e.query.getAll(Ue),o=i.length>0;if(o){const f={};for(const d of i){const u=r[d];f[d]=u}r=f}const a=o?{loaders:r,status:t!==200?t:200,href:B(e.url)}:{loaders:r,action:e.sharedMap.get(q),status:t!==200?t:200,href:B(e.url),redirect:n??void 0,isRewrite:e.sharedMap.get(pe)},c=e.getWritableStream().getWriter(),s=await O([a]);c.write(Q.encode(s)),e.sharedMap.set(we,a),c.close()}function mn(e){if(e.startsWith("/")){if(!e.includes(M)){const t=new URL(e,"http://localhost");return(t.pathname.endsWith("/")?t.pathname.slice(0,-1):t.pathname)+M+t.search}return e}else return}function ae(){return typeof performance<"u"?performance.now():0}async function S(e,t,n){const r=ae();try{return await n()}finally{const i=ae()-r;let o=e.sharedMap.get(v);o||e.sharedMap.set(v,o=[]),o.push([t,i])}}function gn(e,...t){const n=e.get("content-type")?.split(/;/,1)[0].trim()??"";return t.includes(n)}let J;import("node:async_hooks").then(e=>{J=new e.AsyncLocalStorage}).catch(e=>{console.warn(`
=====================
  Qwik Router Warning:
    AsyncLocalStorage is not available, continuing without it.
    This impacts concurrent async server calls, where they lose access to the ServerRequestEv object.
=====================

`,e)});let G;async function pn(e,t){const{render:n,checkOrigin:r}=t;let{qwikRouterConfig:i}=t;if(i||(G||(G=await import("./@qwik-router-config.js")),i=G),!i)throw new Error("qwikRouterConfig is required.");const{pathname:o,isInternal:a}=K(e.url.pathname),c=await ie(i,o,e.request.method,r??!0,n,a);if(c){const[s,f]=c;return Je(e,s,f,async u=>{const{pathname:m}=K(u.pathname),p=await ie(i,m,e.request.method,r??!0,n,a);if(p){const[w,y]=p;return{loadedRoute:w,requestHandlers:y}}else return{loadedRoute:null,requestHandlers:[]}},i.basePathname)}return null}async function ie(e,t,n,r,i,o){const{routes:a,serverPlugins:c,menus:s,cacheModules:f}=e,d=await Ie(a,s,f,t,o),u=nn(c,d,n,r,fn(i),o);return u.length>0?[d,u]:null}const wn=[
  [
    "/",
    "<html>\n<head>\n  <meta charset=\"utf-8\">\n  <meta http-equiv=\"Status\" content=\"404\">\n  <title>404 Resource Not Found</title>\n  <meta name=\"viewport\" content=\"width=device-width,initial-scale=1\">\n  <style>\n    body { color: #006ce9; background-color: #fafafa; padding: 30px; font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, Roboto, sans-serif; }\n    p { max-width: 600px; margin: 60px auto 30px auto; background: white; border-radius: 4px; box-shadow: 0px 0px 50px -20px #006ce9; overflow: hidden; }\n    strong { display: inline-block; padding: 15px; background: #006ce9; color: white; }\n    span { display: inline-block; padding: 15px; }\n  </style>\n</head>\n<body><p><strong>404</strong> <span>Resource Not Found</span></p></body>\n</html>"
  ]
];function yn(e){for(const[t,n]of wn)if(e.startsWith(t))return n;return ce(404,"Resource Not Found")}const z=new Set(["/.assetsignore","/_headers","/assets/DwKlUqTr-bundle-graph.json","/assets/lHBABo2v-style.css","/build/q-BBV_69VP.js","/build/q-BGRYzZvs.js","/build/q-BlBhxniK.js","/build/q-Bppm3ZuM.js","/build/q-BtWyVIyn.js","/build/q-CCD3rDwA.js","/build/q-CHHmrzVS.js","/build/q-Ci7zTIgV.js","/build/q-CiInZcS3.js","/build/q-CwMNAqGx.js","/build/q-D3gZr562.js","/build/q-D4fuHXCw.js","/build/q-D9L7LZG3.js","/build/q-DMG74GlP.js","/build/q-DM_l5X5x.js","/build/q-DXEapYDR.js","/build/q-DcwW76v2.js","/build/q-DmjIisdf.js","/build/q-DnXKoI38.js","/build/q-DneY-1K7.js","/build/q-FzhEhvli.js","/build/q-G_HaNKaS.js","/build/q-I8PrOKcs.js","/build/q-IcaaTDLN.js","/build/q-LoqHeYCC.js","/build/q-PupFOWHX.js","/build/q-ci_rd7bd.js","/build/q-dp5JxKGw.js","/build/q-eb1A0Xnz.js","/build/q-utxE02us.js","/build/q-xbjexvGE.js","/q-manifest.json","/sitemap.xml"]);function se(e,t){if(e.toUpperCase()!=="GET")return!1;const n=t.pathname;if(n.startsWith("/"+(globalThis.__QWIK_BUILD_DIR__||"build")+"/")||n.startsWith("/"+(globalThis.__QWIK_ASSETS_DIR__||"assets")+"/")||z.has(n))return!0;if(n.endsWith("/q-data.json")){const r=n.replace(/\/q-data.json$/,"");if(z.has(r+"/")||z.has(r))return!0}return!1}class $ extends Error{constructor(t,n){super(typeof n=="string"?n:void 0),this.status=t,this.data=n}}class E{}class Y extends E{}class Te extends E{constructor(t){super(),this.pathname=t}}class Rn{#e=null;#n=new TextEncoder;#t=new TransformStream({transform:(t,n)=>{t=String(t);let r="";for(let i=0;i<t.length;i++){const o=t[i],a=o.charCodeAt(0);if(this.#e!==null){const c=this.#e;if(this.#e=null,56320<=a&&a<=57343){r+=c+o;continue}r+="�"}if(55296<=a&&a<=56319){this.#e=o;continue}if(56320<=a&&a<=57343){r+="�";continue}r+=o}r&&n.enqueue(this.#n.encode(r))},flush:t=>{this.#e!==null&&t.enqueue(new Uint8Array([239,191,189]))}});get encoding(){return this.#n.encoding}get readable(){return this.#t.readable}get writable(){return this.#t.writable}get[Symbol.toStringTag](){return"TextEncoderStream"}}function bn(e){e.qwikCityPlan&&!e.qwikRouterConfig&&(console.warn("qwikCityPlan is deprecated. Simply remove it."),e.qwikRouterConfig=e.qwikCityPlan);try{new globalThis.TextEncoderStream}catch{globalThis.TextEncoderStream=Rn}e.manifest&&Me(e.manifest);async function t(n,r,i){try{const o=new URL(n.url);if(se(n.method,o))return r.ASSETS.fetch(n);const a=o.hostname!=="127.0.0.1"&&o.hostname!=="localhost"&&o.port===""&&n.method==="GET",c=new Request(o.href,n),s=a?await caches.open("custom:qwikrouter"):null;if(s){const m=await s.match(c);if(m)return m}const d=await pn({mode:"server",locale:void 0,url:o,request:n,env:{get(m){return r[m]}},getWritableStream:(m,p,w,y)=>{const{readable:_,writable:A}=new TransformStream,R=new Response(_,{status:m,headers:Be(p,w)});return y(R),A},getClientConn:()=>({ip:n.headers.get("CF-connecting-ip")||"",country:n.headers.get("CF-IPCountry")||""}),platform:{request:n,env:r,ctx:i}},e);if(d){d.completion.then(p=>{p&&console.error(p)});const m=await d.response;if(m)return m.ok&&s&&m.headers.has("Cache-Control")&&i.waitUntil(s.put(c,m.clone())),m}const u=!n.headers.get("accept")?.includes("text/html")||se(n.method||"GET",o)?"Not Found":yn(o.pathname);return new Response(u,{status:404,headers:{"Content-Type":"text/html; charset=utf-8","X-Not-Found":o.pathname}})}catch(o){return console.error(o),new Response(String(o||"Error"),{status:500,headers:{"Content-Type":"text/plain; charset=utf-8","X-Error":"cloudflare-pages"}})}}return t}const xn=bn,Tn=xn({render:Le}),_n="x-cf-bench-profile",An="public, max-age=0, s-maxage=60, stale-while-revalidate=300",Pn="public, max-age=0, s-maxage=300, stale-while-revalidate=600";function Cn(e){return e==="/stays"||e==="/blog"?"list":e.startsWith("/stays/")||e.startsWith("/blog/")?"detail":null}function Mn(e,t){return t?e==="idiomatic"||e==="mobile-cold"?t==="detail"?Pn:An:"no-store":null}const Ln=async(e,t,n)=>{const r=await Tn(e,t,n);if(!(r.headers.get("content-type")||"").includes("text/html"))return r;const o=new URL(e.url),a=Cn(o.pathname),c=Mn(e.headers.get(_n),a);if(!c)return r;const s=new Headers(r.headers);return s.set("cache-control",c),new Response(r.body,{status:r.status,statusText:r.statusText,headers:s})},kn={fetch:Ln};export{kn as default,Ln as fetch};
